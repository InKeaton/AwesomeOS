
let rec all_pairs = function